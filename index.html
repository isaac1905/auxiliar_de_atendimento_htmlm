<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Site de Uma Página — Exemplo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #f5f7fb;
      --card: #ffffff;
      --accent: #4f46e5;
      --accent-2: #06b6d4;
      --text: #111827;
      --muted: #6b7280;
      --radius: 14px;
      --gap: 18px;
      --max-width: 960px;
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: linear-gradient(180deg, var(--bg), #eef2ff);
      color: var(--text);
    }

    .wrap {
      max-width: var(--max-width);
      margin: 40px auto;
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
      padding: 10px;
      border: 1px solid rgba(15, 23, 42, 0.04);

    }

    .card-inner {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
      padding: 20px;
      border: 1px solid rgba(15, 23, 42, 0.04);
    }

    /* 1ª linha: logo */
    .logo-row {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px;
    }

    .logo {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .logo img {
      height: 56px;
      width: auto;
      border-radius: 10px;
      object-fit: contain;
      box-shadow: 0 6px 18px rgba(79, 70, 229, 0.08);
    }

    .logo .brand {
      display: flex;
      flex-direction: column;
      line-height: 1;
    }

    .logo .brand .title {
      font-weight: 700;
      font-size: 18px;
      color: var(--text);
    }

    .logo .brand .subtitle {
      font-size: 12px;
      color: var(--muted);
    }

    .buttons-row {
      display: flex;
      justify-content: center;
    }

    .btn-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
    }

    button.app-btn {
      background: linear-gradient(180deg, #ffffff, #fafafa);
      border: 1px solid rgba(15, 23, 42, 0.06);
      padding: 10px 16px;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      min-width: 110px;
      transition: transform .12s ease, box-shadow .12s ease;
    }

    button.app-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 24px rgba(79, 70, 229, 0.12);
    }

    .text-row {
      display: flex;
      justify-content: center;
    }

    .output {
      width: 100%;
      max-width: 900px;
      border-radius: 12px;
      border: 1px solid rgba(15, 23, 42, 0.06);
      padding: 12px;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
    }

    textarea#mainText {
      width: 100%;
      min-height: 200px;
      resize: vertical;
      border: none;
      outline: none;
      font-size: 15px;
      line-height: 1.45;
      font-family: inherit;
      background: transparent;
      color: var(--text);
    }

    #input_locador,
    #input_locatario {
      width: 60%;
    }

    #input_cpf_locador,
    #input_cpf_locatario {
      width: 35%;
    }

    #input_logradouro_locador,
    #input_logradouro_locatario,
    #input_logradouro_imovel {
      width: 80%;
    }

    #input_n_locador,
    #input_n_locatario,
    #input_uf_locador,
    #input_uf_locatario,
    #input_uf_imovel,
    #input_n_imovel {
      width: 15%;
    }

    .form-row {
      display: none;
      /* começa oculto */
      justify-content: center;
    }

    form {
      width: 100%;
      max-width: 80%;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .form-line {
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      align-items: center;
      justify-content: space-evenly;
      max-width: 95%;
      margin: 8px;
    }

    .radiobutton-container {
      color: #6b7280;
      border: none;
      padding: 10px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      margin: 5px;
      flex-wrap: nowrap;
    }

    input,
    select,
    textarea {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }

    button.submit-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 10px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
    }

    button.submit-btn:hover {
      background: var(--accent-2);
    }

    h5 {
      margin: 0;
    }

    .form-input {
      margin: 5px;
    }

    .pdf_viewer {
      display: none;
      /* começa oculto */
      justify-content: center;
      align-items: center;
      margin-top: 20px;
      background: white;
      padding: 10px;
      flex-direction: column;
    }

    iframe {
      width: 100%;
      height: 400px;
      border: none;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
    }

    .label-div {
      margin: 5px;
    }

    @page {
      size: a4 portrait;
      margin-top: 2cm;
      margin-bottom: 2cm;
    }
  </style>
</head>

<body>
  <main class="wrap">

    <!-- Logo -->
    <section class="card logo-row" aria-label="Cabeçalho com logomarca">
      <div class="logo">
        <img src="reduzida.webp" alt="Logomarca da Max Ink">
        <!-- Substitua o src acima pela URL da sua logomarca -->
        <div class="brand" aria-hidden="true">
          <span class="title">Max Ink</span>
          <span class="subtitle">Auxiliar de atendimento</span>
        </div>
      </div>
    </section>

    <!-- Botões -->
    <section class="card buttons-row">
      <div class="btn-group">
        <button class="app-btn" onclick="mostrarFormulario('formCobranca')">Cobrança</button>
        <button class="app-btn" onclick="mostrarFormulario('coleta_form')">Confirmação de Coleta</button>
        <button class="app-btn" onclick="mostrarFormulario('visita_form')">Confirmação de Visita</button>
        <button class="app-btn" onclick="mostrarFormulario('formInformativoWhatsapp')">Informativo Whatsapp</button>
        <button class="app-btn" onclick="acao(5)">Orçamento</button>
        <button class="app-btn" onclick="reparo_em_placa()">Termo de Reparo em Placa</button>
        <button class="app-btn" onclick="mostrarFormulario('contrato_locacao_form')">Contrato de Locação</button>
        <button class="app-btn" onclick="mostrarFormulario('form2')">Contrato de Venda Veículos</button>
        <button class="app-btn" onclick="mostrarFormulario('contrato_compra_e_venda_imovel')">Contrato de Venda Imobiliária</button>
      </div>
    </section>

    <!-- Área de formulários -->
    <section id="formArea" class="card form-row">

      <!-- Formulário Informativo Whatsapp -->
      <form id="formInformativoWhatsapp" style="display:none">
        <h3>Informativo Whatsapp</h3>
        <input id='prazo_orc_form_1' type="number" placeholder="Prazo de Orçamento (Em dias)">
        <input id='valor_coleta_form_1' type="number" precision="2" placeholder="Valor">
        <button type="button" class="submit-btn" onclick="informativo_whatsapp()">Gerar Texto</button>
      </form>

      <!-- Formulário Cobrança -->
      <form id="formCobranca" style="display:none">
        <h3>Cobrança</h3>
        <input id='nome_cobranca' type="text" placeholder="Nome">
        <input id='valor_cobranca' type="number" placeholder="Valor">
        <input id='vencimento' type="text" placeholder="Vencimento" onfocus="(this.type='date')">
        <button type="button" class="submit-btn" onclick="cobranca()">Gerar Texto</button>
      </form>

      <!-- Formulário Coleta -->
      <form id="coleta_form" style="display:none">
        <h3>Confirmação de Coleta</h3>
        <div class="form-line">
          <div class="form-line form-input">
            <h5>R$</h5>
            <input type="number" placeholder="Taxa de deslocamento" class="form-input" id='valor_deslocamento'>
          </div>
          <input id='data_coleta' type="text" placeholder="Data de Coleta" onfocus="(this.type='date')">
        </div>
        <h5>Periodo de Coleta</h5>
        <div class="form-line">
          <div class="radiobutton-container">
            <input type="radio" name="radio_periodo_coleta" id="periodo_manha" value="manha" checked>
            <label for="periodo_manha">Manhã (8:00 as 11:00)</label>
          </div>
          <div class="radiobutton-container">
            <input type="radio" name="radio_periodo_coleta" id="periodo_tarde" value="tarde">
            <label for="periodo_tarde">Tarde ( 13:00 as 17:00 )</label>
          </div>
        </div>
        <button type="button" class="submit-btn" onclick="coleta()">Gerar Mensagem de Texto</button>
      </form>

      <!-- Formulário Visita -->
      <form id="visita_form" style="display:none">
        <h3>Confirmação de Visita</h3>
        <div class="form-line">
          <div class="form-line form-input">
            <h5>R$</h5>
            <input type="number" placeholder="Taxa de deslocamento" class="form-input" id='deslocamento_visita'>
          </div>
          <div class="form-line form-input">
            <h5>R$</h5>
            <input type="number" placeholder="Valor da Visita" class="form-input" id='valor_visita'>
          </div>
        </div>
        <input id='data_visita' type="text" placeholder="Data do Agendamento" onfocus="(this.type='date')">
        <h5>Periodo de Visita</h5>
        <div class="form-line">
          <div class="radiobutton-container">
            <input type="radio" name="radio_periodo_visita" id="periodo_manha_visita" value="manha" checked>
            <label for="periodo_manha_visita">Manhã (8:00 as 11:00)</label>
          </div>
          <div class="radiobutton-container">
            <input type="radio" name="radio_periodo_visita" id="periodo_tarde_visita" value="tarde">
            <label for="periodo_tarde_visita">Tarde ( 13:00 as 17:00 )</label>
          </div>
        </div>
        <button type="button" class="submit-btn" onclick="visita()">Gerar Mensagem de Texto</button>
      </form>

      <!-- Formulário Contrato de Locação -->
      <form id="contrato_locacao_form" style="display:none">
        <h2>Contrato de Locação</h2>
        <div class="card-inner"> <!-- Dados do Locador -->
          <h4>Dados do Locador</h4>
          <div class="form-line">
            <input type="text" name="locador" id="input_locador" placeholder="Nome do Locador" required>
            <input type="text" name="cpf" id="input_cpf_locador" placeholder="CPF do Locador" required>
          </div>

          <h5>Endereço do Locador</h5>
          <div class="form-line">
            <input type="button" value="Buscar CEP"
              onclick="preencher_endereco(document.getElementById('input_cep_locador').value, '_locador')">
            <input type="text" name="cep" id="input_cep_locador" placeholder="CEP" required>
            <input type="text" name="cidade" id="input_cidade_locador" placeholder="Cidade" required>
            <input type="text" name="UF" id="input_uf_locador" placeholder="UF" required>

          </div>
          <div class="form-line">
            <input type="text" name="logradouro" id="input_logradouro_locador" placeholder="Logradouro" required>
            <input type="text" name="n" id="input_n_locador" placeholder="Número" required>
          </div>
          <div class="form-line" style="align-items: start;">
            <input type="text" name="bairro" id="input_bairro_locador" placeholder="Bairro" required>
            <input type="text" name="complemento" id="input_complemento_locador" placeholder="Complemento">

          </div>
        </div>
        <div class="card-inner">
          <h4>Dados do Locatário</h4>
          <div class="form-line">
            <input type="text" name="locatario" id="input_locatario" placeholder="Nome do Locatário" required>
            <input type="text" name="cpf" id="input_cpf_locatario" placeholder="CPF do Locador" required>
          </div>

          <h5>Endereço do Locatário</h5>
          <div class="form-line">
            <input type="button" value="Buscar CEP"
              onclick="preencher_endereco(document.getElementById('input_cep_locatario').value, '_locatario')">
            <input type="text" name="cep_locatario" id="input_cep_locatario" placeholder="CEP" required>
            <input type="text" name="cidade_locatario" id="input_cidade_locatario" placeholder="Cidade" required>
            <input type="text" name="UF_locatario" id="input_uf_locatario" placeholder="UF" required>
          </div>
          <div class="form-line">
            <input type="text" name="logradouro_locatario" id="input_logradouro_locatario" placeholder="Logradouro"
              required>
            <input type="text" name="n_locatario" id="input_n_locatario" placeholder="Número" required>
          </div>
          <div class="form-line">
            <input type="text" name="bairro_locatario" id="input_bairro_locatario" placeholder="Bairro" required>
            <input type="text" name="complemento_locatario" id="input_complemento_locatario" placeholder="Complemento">
          </div>
        </div>
        <div class="card-inner">
          <h4>Dados Do Imóvel</h4>
          <div class="form-line">
            <input type="button" value="Buscar CEP"
              onclick="preencher_endereco(document.getElementById('input_cep_imovel').value, '_imovel')">
            <input type="text" name="cep" id="input_cep_imovel" placeholder="CEP" required>
            <input type="text" name="cidade" id="input_cidade_imovel" placeholder="Cidade" required>
            <input type="text" name="UF" id="input_uf_imovel" placeholder="UF" required>
          </div>
          <div class="form-line">
            <input type="text" name="logradouro" id="input_logradouro_imovel" placeholder="Logradouro" required>
            <input type="text" name="n" id="input_n_imovel" placeholder="Número" required>
          </div>
          <div class="form-line">
            <input type="text" name="bairro" id="input_bairro_imovel" placeholder="Bairro" required>
            <input type="text" name="complemento" id="input_complemento_imovel" placeholder="Complemento">
          </div>
        </div>
        <div class="card-inner">
          <h4>Condiçoes de Aluguel</h4>
          <h5>Finalidade</h5>
          <div class="form-line">
            <div class="radiobutton-container">
              <input type="radio" name="radio_aluguel" id="aluguel_comercial" value="comercial">
              <label for="aluguel_comercial">Comercial</label>
            </div>
            <div class="radiobutton-container">
              <input type="radio" name="radio_aluguel" id="aluguel_residencial" value="residencial" checked>
              <label for="aluguel_residencial">Residencial</label>
            </div>
          </div>
          <div class="form-line">
            <div class="label-div">
              <h5>Prazo de Contrato</h5>
              <input type="number" name="prazo" id="input_prazo" placeholder="Prazo (anos)" required>
            </div>
            <div class="label-div">
              <h5>Data de Inicio</h5>
              <input type="date" name="data_inicio" id="input_data_inicio" placeholder="Data de Início" required>
            </div>
            <div class="label-div">
              <h5>Data da Assinatura</h5>
              <input type="date" name="data_assinatura" id="input_data_assinatura" placeholder="Data de Assinatura"
                required>
            </div>

          </div>
          <div class="form-line">
            <input type="text" name="valor" id="input_valor" placeholder="Valor do Aluguel" required>
            <input type="number" name="data_vencimento" id="input_data_vencimento" placeholder="Dia de Vencimento"
              required>
            <select name="" id="input_formas_pgt">
              <option value="em dinheiro no endereço definido pelo Locatário">Dinheiro</option>
              <option value="por transferência Pix na conta definida pelo Locatário">Pix</option>
              <option value="por meio de depósito bancário na conta definida pelo Locatário">Depósito Bancário</option>
              <option value="via boleto bancário que será enviado mensalmente pelo Locatário">Boleto Bancário</option>
            </select>
          </div>
        </div>

        <button type="button" class="submit-btn" onclick="gerarPDF()">Gerar PDF</button>
      </form>

      <form id="contrato_compra_e_venda_imovel" style="display: none;">
        <h2>Contrato de Compra e Venda de Imóvel</h2>
        <div class="card-inner">
          <h4>Dados do Vendedor</h4>
          <div class="form-line">
            <input type="text" id="input_vendedor_i" placeholder="Nome do Vendedor" required>
            <input type="text" id="input_nacionalidade_vendedor_i" placeholder="Nacionalidade" required>
            <input type="text" id="input_profissao_vendedor_i" placeholder="Profissão" required>
            <input type="text" id="input_estado_civil_vendedor_i" placeholder="Estado Civil" required>
          </div>
          <div class="form-line">
            <input type="text" id="input_rg_vendedor_i" placeholder="RG" required>
            <input type="text" id="input_cpf_vendedor_i" placeholder="CPF" required>
          </div>
          <div class="form-line">
            <input type="text" id="input_logradouro_vendedor_i" placeholder="Logradouro" required>
            <input type="text" id="input_n_vendedor_i" placeholder="Número" required>
            <input type="text" id="input_bairro_vendedor_i" placeholder="Bairro" required>
            <input type="text" id="input_cidade_vendedor_i" placeholder="Cidade" required>
            <input type="text" id="input_uf_vendedor_i" placeholder="UF" required>
          </div>
        </div>
        <div class="card-inner">
          <h4>Dados do Comprador</h4>
          <div class="form-line">
            <input type="text" id="input_comprador" placeholder="Nome do Comprador" required>
          </div>
        </div>
        <div class="card-inner">
          <h4>Dados do Imóvel</h4>
          <div class="form-line">
            <input type="text" id="input_endereco_imovel" placeholder="Endereço do Imóvel" required>
            <input type="text" id="input_matricula_imovel" placeholder="Matrícula do Imóvel" required>
            <input type="text" id="input_comarca_imovel" placeholder="Comarca" required>
            <input type="text" id="input_uf_imovel" placeholder="UF" required>
          </div>
        </div>
        <div class="card-inner">
          <h4>Pagamento</h4>
          <div class="form-line">
            <input type="text" id="input_valor" placeholder="Valor da Venda" required>
            <input type="text" id="input_forma_pgt_imovel" placeholder="Forma de Pagamento" required>
            <input type="text" id="input_custas_de_transferencia" placeholder="Custas de Transferência" required>
          </div>
        </div>
        <div class="card-inner">
          <h4>Local e Data</h4>
          <div class="form-line">
            <input type="text" id="input_cidade_foro" placeholder="Cidade do Foro" required>
            <input type="text" id="input_cidade_ass" placeholder="Cidade da Assinatura" required>
            <input type="number" id="input_dia" placeholder="Dia da Assinatura" required>
            <input type="text" id="input_mes" placeholder="Mês da Assinatura" required>
          </div>
        </div>
        <div class="card-inner">
          <h4>Assinaturas</h4>
          <div class="form-line">
            <input type="text" id="input_locador" placeholder="Locador (se aplicável)">
            <input type="text" id="input_locatario" placeholder="Locatário (se aplicável)">
          </div>
        </div>
        <button type="button" class="submit-btn" onclick="gerarPDFCompraEVenda()">Gerar PDF</button>
      </form>
    </section>

    <section class='pdf_viewer card'>
      <iframe src="contato_locacao.html" width="600" height="400"></iframe>
      <button style='margin: 15px;' type="button" class="submit-btn" onclick="imprimir_pdf()">Imprimir PDF</button>
    </section>

    <!-- Caixa de texto -->
    <section class="card text-row">
      <div class="output">
        <textarea id="mainText" placeholder="Clique duas vezes para copiar..."></textarea>
      </div>
    </section>

  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/viacep-js@1.0.5/dist/viacep.min.js"></script>
  <script>

    async function buscarCEP(cep) {
      try {
        const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
        const data = await response.json();
        return data;
      } catch (error) {
        console.error("Erro ao buscar CEP:", error);
        return null;
      }
    }

    function validaCPF(cpf) {
      var Soma = 0
      var Resto

      var strCPF = String(cpf).replace(/[^\d]/g, '')

      if (strCPF.length !== 11)
        return false

      if ([
        '00000000000',
        '11111111111',
        '22222222222',
        '33333333333',
        '44444444444',
        '55555555555',
        '66666666666',
        '77777777777',
        '88888888888',
        '99999999999',
      ].indexOf(strCPF) !== -1)
        return false

      for (i = 1; i <= 9; i++)
        Soma = Soma + parseInt(strCPF.substring(i - 1, i)) * (11 - i);

      Resto = (Soma * 10) % 11

      if ((Resto == 10) || (Resto == 11))
        Resto = 0

      if (Resto != parseInt(strCPF.substring(9, 10)))
        return false

      Soma = 0

      for (i = 1; i <= 10; i++)
        Soma = Soma + parseInt(strCPF.substring(i - 1, i)) * (12 - i)

      Resto = (Soma * 10) % 11

      if ((Resto == 10) || (Resto == 11))
        Resto = 0

      if (Resto != parseInt(strCPF.substring(10, 11)))
        return false

      return true
    }

    const formatadorMoeda = new Intl.NumberFormat('pt-BR', {
      style: 'currency',
      currency: 'BRL',
      minimumFractionDigits: 2, // Define o número mínimo de casas decimais
      maximumFractionDigits: 2  // Define o número máximo de casas decimais
    });

    function acao(id) {
      const txt = document.getElementById('mainText');
      const time = new Date().toLocaleString();
      txt.value = `Ação ${id} executada em ${time}.`;
    };

    function esconder_forms() {
      const formArea = document.getElementById("formArea");
      const forms = formArea.querySelectorAll("form");
      formArea.style.display = 'none'
      forms.forEach(f => f.style.display = "none");
    };

    function reparo_em_placa() {
      esconder_forms();
      const text = document.getElementById('mainText');
      text.value = '*ATENÇÃO REPARO EM PLACA*\r\n\r\nA autorização do reparo da placa é feita pelo cliente, logo, todos os riscos que porventura venha ocorrer se torna evidente na avaliação do técnico e por fim, na assinatura do check list. \r\n\r\nReitero que os equipamentos podem apresentar novas falhas, a depender dos processos de reparos. Deste modo, o(s) equipamento(s) corre(m) risco de perder alguma funcionalidade permanentemente, devido ao alto grau de dificuldade do reparo. \r\n\r\nTambém é de conhecimento do cliente que o equipamento passará por soldas e outros processos pertinentes para entrega do reparo solicitado. \r\n\r\nDito isso, reitero os riscos envolvidos nessa operação delicada de restauração do(s) seu(s) equipamento(s).\r\n\r\nQuaisquer dúvidas estamos a disposição.'
    };

    function informativo_whatsapp() {
      const txt = document.getElementById('mainText');
      const prazo_orc = document.getElementById('prazo_orc_form_1').value;
      const valor = formatadorMoeda.format(document.getElementById('valor_coleta_form_1').value);
      txt.value = `Recolheremos o equipamento de acordo com a data combinada e será enviada a Ordem de Serviço em PDF para você ler e concordar com os termos descriminados. \r\n\r\n> *Informações importantes:*\r\n\r\n- *Taxa de deslocamento:* ${valor} (Já inclui a recolha e a entrega da máquina na finalização do serviço)\r\nImportante ressaltar que o entregador não dispõe de conhecimento técnico, em casos de necessidade de desinstalação do equipamento na coleta, instalação do equipamento na entrega ou outro serviço que dependa de conhecimento técnico, consulte valores e horários para envio de um profissional capacitado.\r\n\r\n- *Prazo de orçamento:* ${prazo_orc} dias úteis\r\nO prazo poderá ser adiantado, de acordo com disponibilidade técnica. Em caso de necessidade de prorrogação avisaremos anteriormente.`;
    };

    function cobranca() {
      const txt = document.getElementById('mainText');
      const nome = document.getElementById('nome_cobranca').value;
      const vencimento = new Date(document.getElementById('vencimento').value + 'T00:00:00').toLocaleDateString();
      const valor_cobranca = formatadorMoeda.format(document.getElementById('valor_cobranca').value);
      txt.value = `Caro(a) ${nome},\r\n\r\n“Espero que você esteja bem. Gostaria de lembrá-lo(a) de que sua fatura no valor de R$ ${valor_cobranca} venceu em ${vencimento}. Até o momento, ainda não recebemos o pagamento.\r\n\r\nPor favor, lembre-se de que o pagamento em dia é importante para mantermos nosso relacionamento comercial saudável. Caso haja algum problema em relação ao pagamento, por favor, entre em contato conosco para que possamos trabalhar juntos em uma solução.\r\n\r\nAgradecemos sua atenção e aguardamos seu pagamento em breve.\r\n\r\nAtenciosamente,\r\n\r\nMax Ink Soluções em Informática`;
    };

    function coleta() {
      const text = document.getElementById('mainText');
      const valor = formatadorMoeda.format(document.getElementById('valor_deslocamento').value)
      const data_coleta = new Date(document.getElementById('data_coleta').value + 'T00:00:00').toLocaleDateString();
      const periodo = (document.querySelector('input[name="radio_periodo_coleta"]:checked').value == 'manha') ? 'Manhã (8:00 as 11:00)' : 'Tarde ( 13:00 as 17:00 )';
      text.value = `*AGENDAMENTO CONFIRMADO*\r\n\r\n> *COLETA*\r\n- *Taxa de deslocamento:* ${valor} \r\n- *Data:* ${data_coleta}\r\n- *Período:* ${periodo}\r\n\r\n> *INSTRUÇOES PARA COLETA*\r\n\r\n- Em caso de impressora não é necessário mandar os cabos, somente quando solicitado.\r\n- Em caso de notebook é necessário mandar a fonte.\r\n- Em caso de aparelhos telefone, enviar sem chip, cartão de memória e capinha.\r\n- Enviar impressora com seus suprimentos. (Tinta, Cartuchos, Toner)`;
    };

    function visita() {
      const text = document.getElementById('mainText');
      const valor_deslocamento = formatadorMoeda.format(document.getElementById('deslocamento_visita').value)
      const valor_visita = formatadorMoeda.format(document.getElementById('valor_visita').value)
      const data_visita = new Date(document.getElementById('data_visita').value + 'T00:00:00').toLocaleDateString();
      const periodo = (document.querySelector('input[name="radio_periodo_visita"]:checked').value == 'manha') ? 'Manhã (8:00 as 11:00)' : 'Tarde ( 13:00 as 17:00 )';
      text.value = `*AGENDAMENTO CONFIRMADO VISITA TÉCNICA*:\r\n\r\n\r\n- *Taxa de deslocamento:* ${valor_deslocamento}\r\n- *Taxa visita técnica:* ${valor_visita}\r\n- *Data:* ${data_visita} \r\n- *Período:*  ${periodo}\r\n\r\n> Instruções para Visita\r\n\r\n- Em caso de impressora tenham cabos e suprimentos (tinta, cartucho, folha, rede de internet) disponíveis no local.\r\n- Em caso de computadores tenha cabos e acesso a rede internet disponível no local.`;
    }

    // Copiar texto com duplo clique
    document.getElementById('mainText').addEventListener('dblclick', function () {
      const text = this.value;
      if (text.trim() !== "") {
        navigator.clipboard.writeText(text).then(() => {
          alert("Texto copiado para a área de transferência!");
        }).catch(err => {
          console.error("Erro ao copiar:", err);
        });
      }
    });

    document.getElementById('input_cep_locador').addEventListener('input', function (e) {
      let value = e.target.value;
      value = value.replace(/\D/g, ''); // Remove caracteres não numéricos
      value = value.substring(0, 5) + (value.length > 5 ? '-' + value.substring(5, 8) : ''); // Adiciona o hífen
      value = value.substring(0, 2) + '.' + value.substring(2); // Adiciona o ponto
      e.target.value = value;
    });

    document.getElementById('input_cep_locatario').addEventListener('input', function (e) {
      let value = e.target.value;
      value = value.replace(/\D/g, ''); // Remove caracteres não numéricos
      value = value.substring(0, 5) + (value.length > 5 ? '-' + value.substring(5, 8) : ''); // Adiciona o hífen
      value = value.substring(0, 2) + '.' + value.substring(2); // Adiciona o ponto
      e.target.value = value;
    });

    document.getElementById('input_cep_imovel').addEventListener('input', function (e) {
      let value = e.target.value;
      value = value.replace(/\D/g, ''); // Remove caracteres não numéricos
      value = value.substring(0, 5) + (value.length > 5 ? '-' + value.substring(5, 8) : ''); // Adiciona o hífen
      value = value.substring(0, 2) + '.' + value.substring(2); // Adiciona o ponto
      e.target.value = value;
    });

    document.getElementById('input_cpf_locador').addEventListener('input', function (e) {
      let value = e.target.value;
      value = value.replace(/\D/g, ''); // Remove caracteres não numéricos
      value = value.substring(0, 3) + (value.length > 3 ? '.' + value.substring(3, 6) : '') +
        (value.length > 6 ? '.' + value.substring(6, 9) : '') +
        (value.length > 9 ? '-' + value.substring(9, 11) : ''); // Formata o CPF
      e.target.value = value;
    });

    document.getElementById('input_cpf_locatario').addEventListener('input', function (e) {
      let value = e.target.value;
      value = value.replace(/\D/g, ''); // Remove caracteres não numéricos
      value = value.substring(0, 3) + (value.length > 3 ? '.' + value.substring(3, 6) : '') +
        (value.length > 6 ? '.' + value.substring(6, 9) : '') +
        (value.length > 9 ? '-' + value.substring(9, 11) : ''); // Formata o CPF
      e.target.value = value;
    });

    document.getElementById('input_cpf_locador').addEventListener('blur', function (e) {
      if (!validaCPF(e.target.value)) {
        alert("CPF inválido. Por favor, verifique o número informado.");
        e.target.value = ''; // Limpa o campo se o CPF for inválido
      }
    });

    document.getElementById('input_cpf_locatario').addEventListener('blur', function (e) {
      if (!validaCPF(e.target.value)) {
        alert("CPF inválido. Por favor, verifique o número informado.");
        e.target.value = ''; // Limpa o campo se o CPF for inválido
      }
    });

    document.getElementById('input_valor').addEventListener('input', function (e) {
      let value = e.target.value;
      value = value.replace(/\D/g, ''); // Remove caracteres não numéricos
      value = (value / 100).toFixed(2); // Converte para formato monetário
      e.target.value = formatadorMoeda.format(value);
    });

    async function preencher_endereco(cep, key) {

      cep = cep.replace(/\D/g, ''); // Remove caracteres não numéricos

      if (cep.length === 8) {

        const endereco = await buscarCEP(cep);
        if (endereco) {
          document.getElementById('input_logradouro' + key).value = endereco.logradouro || '';
          document.getElementById('input_bairro' + key).value = endereco.bairro || '';
          document.getElementById('input_cidade' + key).value = endereco.localidade || '';
          document.getElementById('input_uf' + key).value = endereco.uf || '';
        } else {
          console.error("Endereço não encontrado para o CEP:", cep);
          alert("Não foi possível encontrar o endereço para o CEP informado.");
        }

      } else {
        console.error("CEP inválido:", cep);
        alert("Por favor, insira um CEP válido com 8 dígitos.");
      }
    }

    // Mostrar formulário
    function mostrarFormulario(id) {


      switch (id) {
        case 'contrato_locacao_form':

          document.getElementById('input_data_assinatura').value = new Date().toISOString().split('T')[0];
          document.getElementById('input_data_inicio').value = new Date().toISOString().split('T')[0];

          break;

        default:
          break;
      }
      esconder_forms();

      const formSelecionado = document.getElementById(id);
      if (formSelecionado) {
        formArea.style.display = "flex"; // mostra a área
        formSelecionado.style.display = "flex"; // mostra o form
      }
    }

    function preencherDocumento(doc, dados) {
      // Preenche os campos do documento com os dados do contrato

      for (const key in dados) {

        if (dados.hasOwnProperty(key)) {
          const value = dados[key];
          const element = doc.querySelector(`#${key}`);
          if (element) {
            element.textContent = value;
          }
        }
      }
      // Exibe o documento preenchido no iframe
      const iframe = document.querySelector('iframe[src="contato_locacao.html"]');
      if (iframe) {
        const docContent = new XMLSerializer().serializeToString(doc);
        iframe.srcdoc = docContent;
      }
    }

    function gerarPDF() {
      const cl_residencial = 'A locação destina-se ao uso exclusivo como residência e domicilio do LOCATÁRIO.';
      const cl_comercial = 'A locação destina-se ao uso exclusivo como estabelecimento comercial do LOCATÁRIO.';

      const cl_residencial_8_comercial = 'O imóvel da presente locação destina-se ao uso exclusivo como residencial do LOCATÁRIO';
      const cl_comercial_8_residencial = 'O imóvel da presente locação destina-se ao uso exclusivo como estabelecimento comercial do LOCATÁRIO';

      esconder_forms();
      // Exemplo de dados para preencher o contrato
      const dadosContrato = {
        locador: document.getElementById('input_locador').value,
        cpf_locador: document.getElementById('input_cpf_locador').value,
        logradouro_locador: document.getElementById('input_logradouro_locador').value,
        n_locador: document.getElementById('input_n_locador').value,
        complemento_locador: document.getElementById('input_complemento_locador').value == "" ? '' : ', ' + document.getElementById('input_complemento_locador').value,
        bairro_locador: document.getElementById('input_bairro_locador').value,
        cidade_locador: document.getElementById('input_cidade_locador').value,
        uf_locador: document.getElementById('input_uf_locador').value,
        cep_locador: document.getElementById('input_cep_locador').value,
        locatario: document.getElementById('input_locatario').value,
        cpf_locatario: document.getElementById('input_cpf_locatario').value,
        logradouro_locatario: document.getElementById('input_logradouro_locatario').value,
        n_locatario: document.getElementById('input_n_locatario').value,
        complemento_locatario: document.getElementById('input_complemento_locatario').value == '' ? '' : ', ' + document.getElementById('input_complemento_locatario').value,
        bairro_locatario: document.getElementById('input_bairro_locatario').value,
        cidade_locatario: document.getElementById('input_cidade_locatario').value,
        uf_locatario: document.getElementById('input_uf_locatario').value,
        cep_locatario: document.getElementById('input_cep_locatario').value,
        finalidade: document.querySelector('input[name="radio_aluguel"]:checked').value,
        prazo: document.getElementById('input_prazo').value,
        data_inicio: new Date(document.getElementById('input_data_inicio').value + 'T00:00:00').toLocaleDateString('pt-BR'),
        valor: document.getElementById('input_valor').value,
        data_vencimento: document.getElementById('input_data_vencimento').value,
        formas_pgt: document.getElementById('input_formas_pgt').value,
        logradouro_imovel: document.getElementById('input_logradouro_imovel').value,
        n_imovel: document.getElementById('input_n_imovel').value,
        complemento_imovel: document.getElementById('input_complemento_imovel').value == '' ? '' : ', ' + document.getElementById('input_complemento_imovel').value,
        bairro_imovel: document.getElementById('input_bairro_imovel').value,
        cidade_imovel: document.getElementById('input_cidade_imovel').value,
        uf_imovel: document.getElementById('input_uf_imovel').value,
        cep_imovel: document.getElementById('input_cep_imovel').value,
        cidade: document.getElementById('input_cidade_imovel').value,
        cidade_ass: document.getElementById('input_cidade_imovel').value,
        dia: new Date(document.getElementById('input_data_assinatura').value).getDate(),
        mes: new Date(document.getElementById('input_data_assinatura').value).toLocaleString('pt-BR', { month: 'long' }),
        clausula_finalidade: document.querySelector('input[name="radio_aluguel"]:checked').value == 'comercial' ? cl_comercial : cl_residencial,
        clausula_finalidade_8: document.querySelector('input[name="radio_aluguel"]:checked').value == 'comercial' ? cl_comercial_8_residencial : cl_residencial_8_comercial,
      };
      const iframe = document.querySelector('iframe[src="contato_locacao.html"]');

      // const doc = iframe.contentDocument || iframe.contentWindow.document;
      const doc = 'contato_locacao.html';
      if (typeof doc === 'string') {
        // Se for uma string, significa que é o caminho do arquivo HTML
        fetch(doc)
          .then(response => response.text())
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            preencherDocumento(doc, dadosContrato);
          })
          .catch(error => console.error("Erro ao carregar o documento:", error));
      } else {
        preencherDocumento(doc, dadosContrato);
      }
      if (!doc) return;

      // Mostra a área de visualização do PDF
      document.querySelector('.pdf_viewer').style.display = 'flex';
    }

    function imprimir_pdf() {
      const iframe = document.querySelector('iframe[src="contato_locacao.html"]');
      if (iframe) {
        // Chama o método de impressão do iframe
        iframe.contentWindow.print();
      } else {
        console.error("Iframe não encontrado.");
      }
    }


    // Mensagem inicial
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('mainText').value = 'Bem-vindo! Clique em um botão para gerar texto.\nBotão 5 ou 6 mostra formulários.\nDê duplo clique aqui para copiar.';
    });
  </script>
</body>

</html>